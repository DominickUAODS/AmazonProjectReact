import styles from "./MainMenu.module.css";
import commonStyles from '../common.module.css';
import { useNavigate } from "react-router-dom";
import UserInMainMenu from "./UserInMainMenu";
import ProductCatalog from "./ProductCatalog";
import MenuSettingsBlock from "./MenuSettingsBlock";
import LogOut from "./LogOut";

export default function MainMenu({ background }: { background: Location }){

    const navigate = useNavigate();
    const isMobile = window.innerWidth <= 768;


    const closeModal = () => {
        navigate(background.pathname || "/");
    };

    const handleBackdropClick = (e: React.MouseEvent<HTMLElement>) => {
		if (e.target === e.currentTarget) {
			closeModal();
		}
	};
    
    
    return(
        <div className={`${commonStyles.modalBackdrop} ${styles.menuModal}`}>
            <div className={styles.menu}>
                <div className={styles.menuInner}>
                    <UserInMainMenu background={background} onClose={closeModal}/>
                    <ProductCatalog/>
                    <MenuSettingsBlock/>
                    <LogOut/>
                </div>
                {!isMobile ? null : (
                <div className={styles.mobileLogoBlock}>
                    <svg width="100" height="40" viewBox="0 0 100 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M40.2867 28.6803V29.3602C40.2867 29.8021 39.9354 30.1534 39.4935 30.1534H26.2923C25.8504 30.1534 25.4991 29.8021 25.4991 29.3602V28.6803C25.4991 28.2384 25.8504 27.8871 26.2923 27.8871H39.4935C39.9241 27.8758 40.2867 28.2384 40.2867 28.6803ZM39.4935 19.1959H26.2923C25.8504 19.1959 25.4991 19.5472 25.4991 19.9891V20.669C25.4991 21.1109 25.8504 21.4622 26.2923 21.4622H39.4935C39.9354 21.4622 40.2867 21.1109 40.2867 20.669V19.9891C40.2867 19.5585 39.9354 19.1959 39.4935 19.1959ZM39.4821 10.5273H26.281C25.8391 10.5273 25.4878 10.8786 25.4878 11.3205V12.0004C25.4878 12.4424 25.8391 12.7936 26.281 12.7936H39.4821C39.9241 12.7936 40.2753 12.4424 40.2753 12.0004V11.3205C40.2753 10.8786 39.9241 10.5273 39.4821 10.5273Z" fill="#4A7BD9"/>
                    <path d="M72.2834 30.1405C71.9888 30.1405 71.7055 30.0272 71.4789 29.8006L62.9803 20.9621C62.6517 20.6335 62.561 20.1462 62.731 19.7156C62.901 19.285 63.3202 19.0131 63.7735 19.0017C66.8103 18.9904 68.0681 18.2879 68.6007 17.6986C68.9973 17.2567 69.1559 16.6788 69.0766 15.9422C68.9066 14.1292 67.2522 12.7128 65.3146 12.7128H59.1163C58.493 12.7128 57.9831 12.2029 57.9831 11.5683C57.9831 10.9337 58.493 10.4238 59.1163 10.4238H65.3146C68.408 10.4238 71.0596 12.7581 71.3316 15.7383C71.4562 17.1207 71.0936 18.3332 70.2777 19.251C69.5185 20.0896 68.4194 20.6788 66.9463 20.9961C66.6857 21.0527 66.5837 21.37 66.765 21.5626L73.0653 28.1802C73.5072 28.6221 73.5072 29.3473 73.0653 29.8006C72.8613 30.0272 72.5667 30.1405 72.2834 30.1405ZM17.1786 10.4352H10.9803C10.3571 10.4352 9.84717 10.9564 9.84717 11.591V28.9961C9.84717 29.6306 10.3571 30.1519 10.9803 30.1519C11.6035 30.1519 12.1135 29.6306 12.1135 28.9961V13.0867C12.1135 12.8941 12.2721 12.7354 12.4534 12.7354H17.1673C19.105 12.7354 20.7593 14.1632 20.9293 15.9876C20.9973 16.7354 20.8387 17.3133 20.4534 17.7553C19.9322 18.3445 18.663 19.0471 15.6262 19.0697C15.003 19.0697 14.4931 19.591 14.5044 20.2255C14.5044 20.8601 15.0143 21.37 15.6375 21.37C18.7877 21.3587 20.9067 20.6788 22.1304 19.2963C22.9463 18.3785 23.3203 17.1547 23.1843 15.7609C22.9237 12.7808 20.2834 10.4352 17.1786 10.4352ZM89.0199 10.4352C88.3967 10.4352 87.8868 10.9677 87.8868 11.6136V17.7326C87.8868 18.4125 87.8981 18.3558 87.8868 18.8544C87.8755 19.2057 87.6602 19.353 87.3995 19.4097C85.6658 19.5456 82.833 19.7496 81.0086 19.0924C78.4704 18.1745 78.2777 15.659 78.2777 11.9196V11.625C78.2777 10.9677 77.7678 10.4465 77.1446 10.4465C76.5214 10.4465 76.0114 10.9791 76.0114 11.625V11.9196C76.0114 15.2397 76.0001 19.7949 80.2607 21.3247C81.4279 21.7439 82.9123 21.8913 84.5214 21.8913C85.4732 21.8913 86.4817 21.8346 87.4789 21.7666C87.6828 21.7553 87.8415 21.9139 87.8415 22.1179C87.8415 22.7071 87.8415 23.421 87.8415 24.2935C87.8415 25.0641 87.5355 25.7326 86.935 26.3105C85.8471 27.353 83.8755 27.9309 82.0171 27.7496C80.0454 27.557 78.7083 26.6051 77.8131 24.7354C77.5299 24.1462 76.85 23.9196 76.2947 24.2029C75.7395 24.4975 75.5129 25.2 75.7848 25.7893C77.0313 28.3842 79.0596 29.8346 81.8131 30.1065C82.1191 30.1405 82.425 30.1519 82.731 30.1519C84.9406 30.1519 87.0823 29.3813 88.476 28.0669C89.5525 27.0357 90.1304 25.7439 90.1304 24.3048C90.1304 21.234 90.1418 20.1575 90.1531 19.3417C90.1531 18.8431 90.1644 18.4352 90.1644 17.7553V11.6363C90.1531 10.9564 89.6432 10.4352 89.0199 10.4352ZM51.3542 21.7099C51.1616 21.5173 51.2636 21.1887 51.5355 21.132C53.0086 20.8034 54.1078 20.2142 54.867 19.3643C55.6828 18.4352 56.0568 17.2114 55.9208 15.8063C55.6375 12.7921 52.9973 10.4352 49.9038 10.4352H43.7055C43.0823 10.4352 42.5724 10.9564 42.5724 11.591V28.9847C42.5724 29.6306 43.0823 30.1405 43.7055 30.1405C44.3287 30.1405 44.8387 29.6193 44.8387 28.9847V13.1094C44.8387 12.9167 44.9973 12.7581 45.1786 12.7581H49.8925C51.8302 12.7581 53.4845 14.1972 53.6545 16.0329C53.7225 16.7921 53.5639 17.37 53.1786 17.8119C52.6574 18.4012 51.3882 19.115 48.3514 19.1264C47.8981 19.1264 47.4789 19.4097 47.3089 19.8403C47.1389 20.2709 47.2296 20.7694 47.5582 21.098L56.0568 29.7893C56.4987 30.2425 57.2126 30.2425 57.6545 29.7893C58.0964 29.336 58.0964 28.5995 57.6545 28.1462L51.3542 21.7099Z" fill="#4A7BD9"/>
                    </svg>

                </div>
            )}
            </div>
            <button className={styles.openCloseMenu} onClick={handleBackdropClick}>
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.65601 3.55273L16.288 14.6407C16.968 15.3447 16.968 16.4647 16.288 17.1687L5.65601 28.2247" stroke="#4A7BD9" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M15.2 3.76758L25.832 14.8556C26.512 15.5596 26.512 16.6796 25.832 17.3836L15.2 28.4396" stroke="#4A7BD9" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    );
}